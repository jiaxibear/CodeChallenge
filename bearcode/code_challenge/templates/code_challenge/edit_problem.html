{% extends "code_challenge/base.html" %}

{% block title %}Edit Problem{% endblock %}

{% block mainbody %}
<style>
    table{
      margin-left: auto;
      margin-right: auto;
      width: 100%;
      border-top: 1px solid lightgrey;
    }
    tr {
        border-bottom: 1px solid lightgrey;
    }
    td, th {
        padding: 5px;
        font-size: 18px;
        font-weight: normal;
    }
    td.plabel {
        text-align: left;
        width: 15%;
    }
    td.pcontent {
        text-align: left;
        width: 85%;
    }
    #java_default,#python_default,#java_tests,#python_tests {
        display: block;
        margin: auto;
        width: 100%;
        height: 200px;
        border: 1px solid #888;
    }

</style>
<script src="/static/ace-builds/src-noconflict/ace.js" type="text/javascript"
        charset="utf-8"></script>
<script src="/static/js/jquery-2.1.4.min.js" type="text/javascript"></script>

<script>
$(document).ready(function() {

    // to render bootstrapped html code
    $("div > select").attr("class","form-control");
    $("div > input").attr("class","form-control");
    $("div > textarea").attr("class","form-control");
    $("div > textarea").attr("rows","3");

    var java_default_div = $("div[data-idx=div_id_java_default]");
    java_default_div.text($("#id_java_default").text());
    java_default_div.attr("id","java_default");

    var java_tests_div = $("div[data-idx=div_id_java_tests]");
    java_tests_div.text($("#id_java_tests").text());
    java_tests_div.attr("id","java_tests");

    var python_default_div = $("div[data-idx=div_id_python_default]");
    python_default_div.text($("#id_python_default").text());
    python_default_div.attr("id","python_default");

    var python_tests_div = $("div[data-idx=div_id_python_tests]");
    python_tests_div.text($("#id_python_tests").text());
    python_tests_div.attr("id","python_tests");

    var java_default = ace.edit("java_default");
    var java_tests = ace.edit("java_tests");
    var python_default = ace.edit("python_default");
    var python_tests = ace.edit("python_tests");

    java_default.setTheme("ace/theme/default");
    java_tests.setTheme("ace/theme/default");
    python_default.setTheme("ace/theme/default");
    python_tests.setTheme("ace/theme/default");

    java_default.getSession().setMode("ace/mode/java");
    java_tests.getSession().setMode("ace/mode/java");
    python_default.getSession().setMode("ace/mode/python");
    python_tests.getSession().setMode("ace/mode/python");

    $("form").submit(function(){
        //alert(java_default.getValue());
        $("#java_default").append("<textarea id='id_java_default' name='java_default'>"+java_default.getValue()+"</textarea>");
        //alert(java_tests.getValue());
        $("#python_default").append("<textarea id='id_python_default' name='python_default'>"+python_default.getValue()+"</textarea>");
        //alert(python_default.getValue());
        $("#java_tests").append("<textarea id='id_java_tests' name='java_tests'>"+java_tests.getValue()+"</textarea>");
        //alert(python_tests.getValue());
        $("#python_tests").append("<textarea id='id_python_tests' name='python_tests'>"+python_tests.getValue()+"</textarea>");
    });
});

</script>
    <div class="container" align="center">

            <div class="container">
              <!-- Example row of columns -->
              <div class="row">

                <div class="col-md-10">
                    <h1>Edit Problem</h1>
                  <br><br>

                  <form method="post" action="{% url 'editproblem' problem.id %}">
                    <table align="center">
                        {% for field in form.visible_fields %}
                        <tr>
                            <td>{{field.label_tag}}</td>
                            <td>
                                <div data-idx="div_{{field.id_for_label}}">
                                {{field}}
                                </div>
                            </td>
                            <td style="color: red">{{field.errors}}</td>
                        </tr>
                        {% endfor %}
                    </table>
                    {% for field in form.hidden_fields %}
                      {{field}}
                    {% endfor %}
                    {% csrf_token %}
                    <a class="btn btn-default" href="{% url 'manageproblem' %}">Cancel</a>
                    <input class="btn btn-success" type="submit" value="Confirm Modify" />
                  </form>
                </div>
            </div>
        </div>
    </div>
{% endblock %}